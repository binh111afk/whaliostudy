# ============================================================
# GitHub Actions: Keep Render Server Alive
# Pings the server every 14 minutes to prevent free-tier spindown
# ============================================================

name: Keep Alive - Ping Server

on:
  # Run every 14 minutes (Render spins down after 15 mins of inactivity)
  schedule:
    - cron: '*/14 * * * *'
  
  # Allow manual trigger from GitHub UI for testing
  workflow_dispatch:

jobs:
  ping:
    name: Ping Server
    runs-on: ubuntu-latest
    
    steps:
      - name: Ping Render Server
        run: |
          curl -s -o /dev/null -w "HTTP Status: %{http_code}\n" \
            -H "User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36" \
            -H "Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8" \
            -H "Accept-Language: en-US,en;q=0.5" \
            -H "Connection: keep-alive" \
            https://whaliostudy.onrender.com/ping
      
      - name: Log Success
        run: echo "âœ… Server pinged successfully at $(date -u '+%Y-%m-%d %H:%M:%S UTC')"
